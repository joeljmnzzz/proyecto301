<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Producci칩n | Proyecto 301</title>

  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/production-project.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flag-icons/css/flag-icons.min.css">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="icon" type="image/svg+xml" href="assets/logos/icon.svg">

  <!-- CDN de Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="production-page">
  <!-- Navbar placeholder -->
  <div id="navbar-placeholder"></div>
  <div class="ball"></div>

  <!-- Contenido Principal -->
  <main class="production-dashboard">
    
    <!-- Contenedor Principal dividido en 3 partes -->
    <div class="dashboard-container">
      
      <!-- Div 1: Header de Navegaci칩n -->
      <div class="dashboard-header-section">
        <header class="project-navigation-header">
          <div class="nav-container">
            <!-- Barra de Navegaci칩n Horizontal -->
            <nav class="project-nav">
              <a class="nav-item">
                <span>MI PROYECTO</span>
              </a>
              <a class="nav-item active">
                <span>TAREAS</span>
              </a>
              <a class="nav-item">
                <span>NUBE</span>
              </a>
              <a class="nav-item">
                <span>SOLICITUDES</span>
              </a>
              <a class="nav-item">
                <span>NOTIFICACIONES</span>
              </a>
            </nav>
          </div>
        </header>
      </div>

      <!-- Div 2: Contenido Principal (Columnas 1 y 2) -->
      <div class="dashboard-content-section">
        
        <!-- Grid de Columnas (Tareas + Actividad/Calendario) -->
        <div class="dashboard-columns-grid">
          
          <!-- Columna 1 - Tareas -->
          <section class="dashboard-column tasks-column">
            <div class="column-header">
              <h2><i class="fas fa-tasks"></i> Tareas Pr칩ximas</h2>
              <button class="btn-add-task" title="Agregar nueva tarea" id="btn-add-task">
                <i class="fas fa-plus"></i>
              </button>
            </div>
            
            <div class="tasks-scroll-container">
              <div class="tasks-container" id="tasks-container">
                <!-- Las tareas se cargar치n din치micamente aqu칤 -->
                <div class="loading-tasks">
                  <i class="fas fa-spinner fa-spin"></i>
                  <span>Cargando tareas...</span>
                </div>
              </div>
            </div>
          </section>

          <!-- Columna 2 - Actividad Reciente -->
          <section class="dashboard-column activity-column">
            <div class="column-header">
              <h2><i class="fas fa-history"></i> Actividad Reciente</h2>
            </div>
            <div class="activity-container" id="activity-container">
              <!-- La actividad se cargar치 din치micamente aqu칤 -->
              <div class="loading-activity">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Cargando actividad...</span>
              </div>
            </div>
          </section>
         
        </div> <!-- Fin del dashboard-columns-grid -->
      </div> <!-- Fin del dashboard-content-section -->
    </div> <!-- Fin del dashboard-container -->

<!-- Modal para crear nueva tarea - VERSI칍N MEJORADA -->
<div id="task-modal" class="modal">
  <div class="modal-content large-modal">
    <div class="modal-header">
      <h3><i class="fas fa-plus-circle"></i> Crear Nueva Tarea</h3>
      <button class="close-modal">&times;</button>
    </div>
    <form id="task-form" class="modal-body">
      <!-- T칤tulo -->
      <div class="form-group">
        <label for="task-title" class="required">T칤tulo</label>
        <input type="text" id="task-title" name="title" required 
               maxlength="200" placeholder="쯈u칠 necesita hacerse?">
        <div class="char-counter">
          <span id="title-char-count">0</span>/200
        </div>
      </div>

      <!-- Descripci칩n -->
      <div class="form-group">
        <label for="task-description">Descripci칩n</label>
        <textarea id="task-description" name="description" rows="4" 
                  placeholder="Describe los detalles de la tarea..." 
                  maxlength="1000"></textarea>
        <div class="char-counter">
          <span id="description-char-count">0</span>/1000
        </div>
      </div>

      <div class="form-row">
        <!-- Asignaci칩n M칰ltiple -->
        <div class="form-group">
          <label for="task-assignees">Asignar a</label>
          <select id="task-assignees" name="assignees" multiple class="multiple-select">
            <option value="">Seleccionar miembros...</option>
          </select>
          <div class="selected-assignees" id="selected-assignees">
            <!-- Los asignados seleccionados aparecer치n aqu칤 -->
          </div>
        </div>

        <!-- Prioridad -->
        <div class="form-group">
          <label for="task-priority" class="required">Prioridad</label>
          <select id="task-priority" name="priority" required>
            <option value="low">游릭 Baja</option>
            <option value="medium" selected>游리 Media</option>
            <option value="high">游 Alta</option>
            <option value="urgent">游댮 Urgente</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <!-- Fecha L칤mite -->
        <div class="form-group">
          <label for="task-due-date">Fecha L칤mite</label>
          <input type="datetime-local" id="task-due-date" name="due_date">
          <div class="date-hint" id="date-hint"></div>
        </div>

        <!-- Estimaci칩n de Esfuerzo -->
        <div class="form-group">
          <label for="task-estimated-hours">Estimaci칩n (horas)</label>
          <input type="number" id="task-estimated-hours" name="estimated_hours" 
                 min="1" max="500" placeholder="Ej: 8">
        </div>
      </div>

      <!-- Etiquetas -->
      <div class="form-group">
        <label for="task-tags">Etiquetas</label>
        <div class="tags-input-container">
          <select id="task-tags" name="tags" multiple class="multiple-select">
            <option value="">Seleccionar etiquetas...</option>
          </select>
          <button type="button" class="btn-add-tag" id="btn-add-tag" title="Crear nueva etiqueta">
            <i class="fas fa-plus"></i>
          </button>
        </div>
        <div class="selected-tags" id="selected-tags">
          <!-- Las etiquetas seleccionadas aparecer치n aqu칤 -->
        </div>
      </div>

      <!-- Validaci칩n y Estado -->
      <div class="form-validation" id="form-validation">
        <!-- Mensajes de validaci칩n aparecer치n aqu칤 -->
      </div>

      <div class="form-actions">
        <button type="button" class="btn-cancel">Cancelar</button>
        <button type="submit" class="btn-primary" id="submit-task-btn">
          <i class="fas fa-plus"></i> Crear Tarea
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal para crear nueva etiqueta -->
<div id="tag-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3><i class="fas fa-tag"></i> Crear Nueva Etiqueta</h3>
      <button class="close-modal">&times;</button>
    </div>
    <form id="tag-form" class="modal-body">
      <div class="form-group">
        <label for="tag-name" class="required">Nombre de la etiqueta</label>
        <input type="text" id="tag-name" name="name" required maxlength="50" 
               placeholder="Ej: Frontend, Bug, Urgente...">
      </div>
      <div class="form-group">
        <label for="tag-color">Color</label>
        <div class="color-picker">
          <input type="color" id="tag-color" name="color" value="#6B7280">
          <div class="color-presets">
            <div class="color-preset" data-color="#EF4444" style="background-color: #EF4444;"></div>
            <div class="color-preset" data-color="#F59E0B" style="background-color: #F59E0B;"></div>
            <div class="color-preset" data-color="#10B981" style="background-color: #10B981;"></div>
            <div class="color-preset" data-color="#3B82F6" style="background-color: #3B82F6;"></div>
            <div class="color-preset" data-color="#8B5CF6" style="background-color: #8B5CF6;"></div>
            <div class="color-preset" data-color="#6B7280" style="background-color: #6B7280;"></div>
          </div>
        </div>
      </div>
      <div class="form-actions">
        <button type="button" class="btn-cancel">Cancelar</button>
        <button type="submit" class="btn-primary">
          <i class="fas fa-tag"></i> Crear Etiqueta
        </button>
      </div>
    </form>
  </div>
</div>

    <!-- Div 3: Chat General Fijo -->
    <section class="chat-column">
      <div class="chat-section">
        <div class="chat-header">
          <div class="chat-info">
            <h2><i class="fas fa-comments"></i> Chat General</h2>
            <div class="active-users">
              <span class="users-count" id="active-users-count">Cargando miembros...</span>
              <div class="users-avatars" id="users-avatars">
                <!-- Los avatares se cargar치n din치micamente -->
              </div>
            </div>
          </div>
          <button class="btn-chat-settings" title="Configuraci칩n del chat">
            <i class="fas fa-cog"></i>
          </button>
        </div>
        
        <div class="messages-container" id="messages-container">
          <!-- Los mensajes se cargar치n din치micamente aqu칤 -->
          <div class="loading-messages">
            <i class="fas fa-spinner fa-spin"></i>
            <span>Cargando mensajes...</span>
          </div>
        </div>
        
        <div class="message-input-container">
          <button class="btn-attach" title="Adjuntar archivo" id="btn-attach-file">
            <i class="fas fa-paperclip"></i>
          </button>
          <div class="input-wrapper">
            <input type="text" placeholder="Escribe un mensaje..." class="message-input" id="message-input">
            <button class="btn-emoji" title="Insertar emoji" id="btn-emoji">
              <i class="fas fa-smile"></i>
            </button>
          </div>
          <button class="btn-send" title="Enviar mensaje" id="btn-send-message">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Scripts -->
  <script src="/js/supabase-client.js" defer></script>
  <script src="/js/i18n.js" defer></script>
  <script src="/js/load-navbar.js" defer></script>
  <script src="/js/production-project.js" defer></script>
  <script src="/js/task-management.js" defer></script>
</body>
</html>